DESARROLLO DEL PROYECTO: CHESSMAGIC
================================================

Este documento detalla el estado de desarrollo actual del proyecto "ChessMagic",
un juego de ajedrez por turnos para dos jugadores locales implementado en Python con la librería Pygame.


SECCIÓN 1: CONCEPTO Y OBJETIVO
------------------------------

El objetivo principal del proyecto es crear una variante estratégica del ajedrez clásico
introduciendo un sistema de habilidades especiales. Cada turno, una pieza aleatoria del jugador
activo recibe una habilidad única que puede cambiar drásticamente el curso del juego,
añadiendo una capa de imprevisibilidad y nuevas tácticas.


SECCIÓN 2: CARACTERÍSTICAS IMPLEMENTADAS
----------------------------------------

El juego se encuentra en una fase funcional, con las siguientes características ya implementadas y operativas:

### 2.1. Motor de Ajedrez Básico

*   **Tablero Funcional:** Se ha implementado un tablero de 8x8 sobre el cual se desarrollan las partidas.
*   **Movimiento de Piezas Estándar:** Todas las piezas tradicionales (Peón, Torre, Caballo, Alfil, Reina, Rey) se mueven de acuerdo con las reglas estándar del ajedrez.
*   **Sistema de Turnos:** El juego alterna correctamente entre el jugador de las piezas blancas y el de las negras.
*   **Lógica de Captura:** Las piezas pueden capturar a las del oponente, eliminándolas del tablero.
*   **Validación de Movimientos:** El sistema valida si un movimiento es legal para la pieza seleccionada antes de permitirlo.

### 2.2. Reglas Avanzadas de Ajedrez

*   **Detección de Jaque (Check):** El juego es capaz de detectar si un rey está bajo amenaza (en jaque).
*   **Prevención de Movimientos Ilegales:** Un jugador no puede realizar un movimiento que deje a su propio rey en jaque. El sistema bloquea dichos movimientos.
*   **Detección de Fin de Partida:** El juego ahora concluye correctamente al detectar Jaque Mate, Ahogado (empate) o si un rey es capturado directamente.

### 2.3. Sistema de Habilidades Especiales

El núcleo innovador del proyecto ya está en funcionamiento:

*   **Asignación Aleatoria:** Al comienzo de cada turno, el sistema asigna automáticamente una habilidad especial a una pieza aleatoria del jugador actual.
*   **Indicadores Visuales de Habilidad:** La pieza que tiene la habilidad activa se resalta con un aura de color distintivo (ej. azul para el peón, verde para la torre), permitiendo al jugador identificarla fácilmente.
*   **Habilidades Funcionales:**
    *   **Omni-Directional Pawn:** Un peón con esta habilidad puede moverse y capturar en cualquiera de las 8 direcciones adyacentes (un solo paso).
    *   **Double-Step Rook:** Una torre que, tras realizar su primer movimiento, puede moverse una segunda vez de forma inmediata.

### 2.4. Interfaz de Usuario (UI) y Experiencia de Juego (UX)

Se ha desarrollado una interfaz gráfica completa y moderna:

*   **Pantalla de Menú Principal Dinámica:** Al iniciar, el jugador es recibido con una pantalla de menú con un fondo de vídeo animado, música de fondo y un título con colores neón que cambian con el tiempo.
    *   **Modos de Juego:** Se puede elegir entre "Modo Clásico" (sin tiempo) y "Modo Cronómetro" (10 minutos por jugador).
*   **Diseño de la Pantalla de Juego:**
    *   **Barra Superior:** Muestra el turno actual, la habilidad activa y el cronómetro del jugador negro (en modo cronómetro).
    *   **Barra Inferior:** Contiene la paleta de colores y el botón "Cambiar Color" a la izquierda, el cronómetro del jugador blanco (en modo cronómetro) y una cuadrícula de iconos de acción en la esquina inferior derecha.
*   **Indicador de Jaque:** Cuando un rey está en jaque, se muestra un aura roja sobre él como advertencia visual.
*   **Personalización del Tablero:** Se ha añadido una paleta de colores en la parte inferior de la pantalla. El jugador puede seleccionar un par de colores y hacer clic en "Cambiar Color" para personalizar la apariencia del tablero en tiempo real.
*   **Ventana de Información:** Un icono de '?' abre una ventana emergente que explica las habilidades disponibles en el juego.
*   **Portabilidad:** Todas las rutas a los recursos (imágenes, sonidos, vídeo) se han hecho relativas, permitiendo que el proyecto se ejecute en cualquier ordenador sin necesidad de modificar el código.


### 2.5. Persistencia de Datos con SQLite

Se ha integrado una base de datos SQLite para permitir a los jugadores guardar, cargar y reiniciar partidas, mejorando significativamente la experiencia de juego.

*   **Iconos de Acción:** Se ha implementado una cuadrícula de iconos en la esquina inferior derecha para un acceso rápido a las funciones de "Guardar" (S), "Cargar" (L), "Reiniciar" (R), "Menú" (M) e "Info" (?).
*   **Guardado de Datos del Juego (Implementado):**
    *   **Estado del Tablero:** La posición de cada pieza, su color, si se ha movido y qué habilidad especial posee (si la tiene) se almacena en la base de datos.
    *   **Turno Actual:** El sistema guarda de quién es el turno (`'white'` o `'black'`) para que la partida se reanude exactamente donde se dejó.
*   **Carga de Datos del Juego (Implementado):** Al cargar, el juego reconstruye el tablero y restaura el turno, permitiendo continuar una partida guardada previamente.
*   **Reinicio de Partida:** El botón "Reiniciar" permite empezar una nueva partida desde cero en cualquier momento.

### 2.6. Sistema de Audio

Se ha implementado un sistema de audio para mejorar la inmersión:

*   **Música de Fondo:** El juego cuenta con pistas de música separadas para el menú principal y para las partidas, con transiciones suaves entre ellas.
*   **Efectos de Sonido:** Se reproduce un efecto de sonido cada vez que un jugador mueve una pieza, proporcionando retroalimentación auditiva.

#### Aplicación Futura de SQLite

La base de datos actual sienta las bases para futuras expansiones:

*   **Guardado de Configuración (No implementado):** La estructura puede ampliarse para guardar las preferencias del usuario, como los colores del tablero seleccionados, para que se carguen automáticamente al iniciar el juego.
*   **Datos del Jugador (No implementado):** Se podría crear una nueva tabla para almacenar perfiles de jugadores, incluyendo nombres, estadísticas de victorias/derrotas y un historial de partidas.
*   **Múltiples Partidas Guardadas (No implementado):** La funcionalidad actual utiliza un único slot de guardado rápido ("quicksave"). En el futuro, se podría implementar un sistema para que los jugadores nombren y gestionen múltiples archivos de guardado.


SECCIÓN 3: ESTRUCTURA TÉCNICA
-----------------------------

El código está organizado de forma modular para facilitar su mantenimiento y expansión:

*   **`pygame juego proyecto.py` (main.py):** Contiene el bucle principal del juego, gestiona los eventos del usuario (clics del ratón) y coordina las actualizaciones y el renderizado.
*   **`board.py`:** Define la clase `Board`, que gestiona la matriz 8x8 y la posición de todas las piezas.
*   **`pieces.py`:** Contiene la clase base `Piece` y las clases derivadas para cada tipo de pieza (`Pawn`, `Rook`, etc.). Aquí se define la lógica de movimiento estándar y los efectos de las habilidades.
*   **`game_logic.py`:** Orquesta las reglas del juego. Gestiona los turnos, la validación de movimientos complejos (como la prevención de jaque) y la asignación de habilidades.
*   **`database.py`:** Gestiona toda la interacción con la base de datos SQLite, incluyendo la creación de tablas y las funciones para guardar y cargar el estado del juego.
*   **`ui.py`:** Centraliza todas las funciones de dibujado de la interfaz, como el tablero, las barras de información y los indicadores visuales.
*   **`config.py`:** Almacena constantes globales como dimensiones de la ventana, colores, rutas a los assets y configuraciones del juego.


SECCIÓN 4: LIMITACIONES ACTUALES Y PRÓXIMOS PASOS
-------------------------------------------------

El proyecto se encuentra en desarrollo activo y tiene las siguientes limitaciones a tener en cuenta:

*   **Reglas Especiales de Ajedrez:** Aún no se han implementado reglas complejas como el enroque (castling), la captura al paso (en passant) o la promoción del peón.
*   **Modo de Juego:** El juego es exclusivamente para dos jugadores locales. No hay inteligencia artificial (IA) como oponente ni modo multijugador en red.
*   **Errores y Descartes:** Durante el desarrollo, se descartaron ideas como la habilidad `area_push_knight` por su complejidad. La interfaz de usuario pasó por varias iteraciones (botones de texto, menú desplegable) hasta llegar al diseño actual de iconos para solucionar problemas de solapamiento y mejorar la estética.

Los próximos pasos se centrarán en añadir las reglas especiales restantes y, potencialmente, una IA básica.


SECCIÓN 5: VIDEO DE DEMOSTRACIÓN
--------------------------------

Puedes ver una demostración del funcionamiento actual del juego en el siguiente enlace:

**[ESPACIO RESERVADO PARA EL LINK DEL VIDEO]**